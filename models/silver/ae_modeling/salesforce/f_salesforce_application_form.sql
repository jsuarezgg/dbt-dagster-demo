{{
    config(
        materialized='table',
        full_refresh = false,
        post_hook=[
            'ANALYZE TABLE {{ this }} COMPUTE STATISTICS',
        ]
    )
}}

SELECT
    a.application_form_id,
    a.application_form_account,
    a.application_form_power_of_1,
    a.application_form_current_step,
    a.application_form_is_deleted,
    a.application_form_status,
    a.application_form_steps_completed,
    a.application_form_submitted_form,
    a.application_form_channels,
    a.application_form_contact,
    a.application_form_es_contacto_mercadeo,
    a.application_form_es_contacto_principal,
    a.application_form_es_representante_legal,
    a.application_form_name,
    a.application_form_posee_porcentaje_empresa,
    a.application_form_guest_user_email,
    a.application_form_representante_legal,
    a.application_form_start_step_0,
    a.application_form_start_step_1,
    a.application_form_start_step_2,
    a.application_form_start_step_3,
    a.application_form_start_step_4,
    a.application_form_start_step_5,
    a.application_form_start_step_6,
    a.application_form_start_step_7,
    a.application_form_start_step_8,
    a.application_form_start_step_9,
    a.application_form_start_step_10,
    a.application_form_start_step_11,
    a.application_form_start_step_12,
    a.application_form_end_step_0,
    a.application_form_end_step_1,
    a.application_form_end_step_2,
    a.application_form_end_step_3,
    a.application_form_end_step_4,
    a.application_form_end_step_5,
    a.application_form_end_step_6,
    a.application_form_end_step_7,
    a.application_form_end_step_8,
    a.application_form_end_step_9,
    a.application_form_end_step_10,
    a.application_form_end_step_11,
    a.application_form_end_step_12,
    a.application_form_step_0_completed,
    a.application_form_step_1_completed,
    a.application_form_step_2_completed,
    a.application_form_step_3_completed,
    a.application_form_step_4_completed,
    a.application_form_step_5_completed,
    a.application_form_step_6_completed,
    a.application_form_step_7_completed,
    a.application_form_step_8_completed,
    a.application_form_step_9_completed,
    a.application_form_step_10_completed,
    a.application_form_step_11_completed,
    a.application_form_step_12_completed,
    a.application_form_step_time_0,
    a.application_form_step_time_1,
    a.application_form_step_time_2,
    a.application_form_step_time_3,
    a.application_form_step_time_4,
    a.application_form_step_time_5,
    a.application_form_step_time_6,
    a.application_form_step_time_7,
    a.application_form_step_time_8,
    a.application_form_step_time_9,
    a.application_form_step_time_10,
    a.application_form_step_time_11,
    a.application_form_step_time_12,
    a.application_form_created_date,
    a.application_form_start_form,
    a.application_form_end_form,
    a.application_form_last_activity_date,
    a.application_form_last_modified_date,
    a.application_form_form_time,
    a.application_form_total_time_days,
    a.application_form_total_time_hours,
    a.application_form_total_time_minutes,
    a.application_form_total_time_seconds,
    a.application_form_last_modified_by,
    a.application_form_created_by,
    a.application_form_owner_id,
    -- MANDATORY FIELDS
    NOW() AS ingested_at,
    to_timestamp('{{ var("execution_date") }}') AS updated_at,
    a.airbyte_emitted_at,
    a.ingested_from_s3_at
from {{ ref('salesforce_application_form')}} a
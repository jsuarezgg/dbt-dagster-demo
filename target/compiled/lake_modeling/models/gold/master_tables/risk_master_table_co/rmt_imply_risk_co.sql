

select
    ocurred_on_date as day,
    client_id,
    ally_slug as ally_name,
    journey_name,
    max(background_check_co_in) as background_check_co_in,
    max(background_check_co_out) as background_check_co_out,
    max(device_information_co_in) as device_information_in,
    max(device_information_co_out) as device_information_out,
    max(fraud_check_co_in) as fraud_check_co_in,
    max(fraud_check_co_out) as fraud_check_co_out,
    --would remove:
    --max(fraud_check_rc_co_in) as fraud_check_rc_co_in,
    --max(fraud_check_rc_co_out) as fraud_check_rc_co_out,
    max(loan_proposals_co_in) as loan_proposals_co_in,
    max(loan_proposals_co_out) as loan_proposals_co_out,
    --would remove:
    --max(loan_proposals_santander_co_in) as loan_proposals_santander_co_in,
    --max(loan_proposals_santander_co_out) as loan_proposals_santander_co_out,
    max(preconditions_co_in) as preconditions_in,
    max(preconditions_co_out) as preconditions_out,
    max(underwriting_co_in) as underwriting_in,
    max(underwriting_co_out) as underwriting_out,
    greatest(max(loan_acceptance_co_in), max(loan_acceptance_v2_co_in)) as loan_acceptance_in,
    greatest(max(loan_acceptance_co_out), max(loan_acceptance_v2_co_out)) as loan_acceptance_out,
    max(identity_verification_co_in) as identity_in,
    max(identity_verification_co_out) as identity_out,
    max(additional_information_co_in) as additional_information_co_in,
    max(additional_information_co_out) as additional_information_co_out,
    max(basic_identity_co_in) as basic_identity_co_in,
    max(basic_identity_co_out) as basic_identity_co_out,
    max(cellphone_validation_co_in) as cellphone_validation_co_in,
    max(cellphone_validation_co_out) as cellphone_validation_co_out,
    max(personal_information_co_in) as personal_information_co_in,
    max(personal_information_co_out) as personal_information_co_out,
    max(preapproval_summary_co_in) as preapproval_summary_co_in,
    max(preapproval_summary_co_out) as preapproval_summary_co_out,
    max(privacy_policy_stage_in) as privacy_policy_stage_in,
    max(privacy_accepted_co_out) as privacy_accepted_co_out,
    max(privacy_expiration_date_co_out) as privacy_expiration_date_co_out,
    max(privacy_first_name_co_out) as privacy_first_name_co_out,
    max(privacy_policy_co_in) as privacy_policy_co_in,
    max(privacy_policy_co_out) as privacy_policy_co_out,
    max(privacy_policy_v2_co_in) as privacy_policy_v2_co_in,
    max(privacy_policy_v2_co_out) as privacy_policy_v2_co_out,
    max(psychometric_assessment_co_in) as psychometric_assessment_co_in,
    max(psychometric_assessment_co_out) as psychometric_assessment_co_out,
    max(work_information_co_in) as work_information_co_in,
    max(work_information_co_out) as work_information_co_out
from gold.dm_application_process_funnel_co
group by 1, 2, 3, 4